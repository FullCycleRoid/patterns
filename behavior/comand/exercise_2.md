#### Задание 2. Реализовать набор классов для варианта паттерна Command с дополнительными возможностями, связанными с созданием макрокоманд и отменой предыдущих действий.

#### Имеются три класса-получателя, реализующих различные действия и умеющих отменять их: класс ReceiverA включает статические методы ActionA (выводит строку «+A») и UndoActionA (выводит строку «−A»), класс ReceiverB включает статические методы ActionB (выводит строку «+B») и UndoActionB (выводит строку «−B»), класс ReceiverC включает статические методы ActionC (выводит строку «+C») и UndoActionC (выводит строку «−C»). Других методов или полей классы-получатели не содержат. Следует подчеркнуть, что эти классы не входят в какую-либо особую иерархию.

#### Иерархия классов-команд начинается с абстрактного класса Command, включающего методы Execute и Unexecute (методы не имеют параметров и не возвращают значений). Его потомками являются классы CommandA, CommandB, CommandC и MacroCommand. Конструкторы классов CommandA, CommandB, CommandC не имеют параметров и не выполняют дополнительных действий. Метод Execute команды A выполняет вызов статического метода ActionA класса-получателя ReceiverA, метод Unexecute команды A выполняет вызов статического метода UndoActionA. Методы Execute и Unexecute команд B и C определяются аналогично, с использованием статических методов классов ReceiverB и ReceiverC.

#### Класс MacroCommand позволяет объединять имеющиеся команды в последовательности команд (макрокоманды). Он содержит структуру данных cmds (например, массив) с элементами-ссылками типа Command, которая инициализируется в конструкторе, имеющем соответствующий параметр-структуру (можно считать, что макрокоманда содержит не более 5 команд). Метод Execute класса MacroCommand выполняет вызов методов Execute всех элементов структуры cmds в исходном порядке, а метод Unexecute — вызов методов Unexecute всех элементов структуры cmds в обратном порядке.

#### Реализовать класс Menu, предоставляющий средства для настройки инициаторов команд, их выполнения, а также выполнения операций отмены и восстановления. Класс Menu содержит две структуры данных: массив menuCmds размера 3, в котором хранятся ссылки на команды, доступные для выполнения, и структуру lastCmds, в котором хранятся ссылки на ранее выполненные команды, что дает возможность отменять эти команды или, после отмены, восстанавливать их. В качестве структуры lastCmds удобно использовать динамическую структуру, позволяющую добавлять в конец новые элементы и удалять часть последних элементов. Можно считать, что структура lastCmds в любой момент времени будет содержать не более 40 элементов. Со структурой lastCmds связано дополнительное целочисленное поле undoIndex, определяющее индекс элемента из lastCmds, после которого следуют ранее отмененные команды (которые впоследствии могут быть восстановлены).

#### Конструктор класса Menu содержит два ссылочных параметра: cmd1 и cmd2 типа Command; эти параметры определяют два начальных элемента массива menuCmds; третий элемент этого массива является макрокомандой (объектом типа MacroCommand), включающей команды cmd1 и cmd2 в указанном порядке.

#### Класс Menu содержит три метода: Invoke(cmdIndex), Undo(count) и Redo(count); методы имеют целочисленные параметры и не возвращают значений.

#### Метод Invoke(cmdIndex) выполняет команду из массива menuCmds с индексом cmdIndex (при реализации этого метода можно считать, что параметр cmdIndex всегда находится в допустимом диапазоне 0–2). Кроме того, при выполнении метода Invoke из структуры lastCmds удаляются все конечные элементы, начиная с элемента с индексом undoIndex + 1 (если такие элементы существуют), в конец структуры lastCmds добавляется ссылка на только что выполненную команду, а значение поля undoIndex полагается равным индексу добавленной команды.

#### Метод Undo(count) отменяет count выполненных команд, хранящихся в структуре lastCmds, начиная с команды с индексом undoIndex в направлении уменьшения индексов (если в структуре lastCmds содержится недостаточно элементов, то отменяются все доступные команды). Для каждой из этих команд вызывается метод Unexecute; кроме того, значение поля undoIndex корректируется так, чтобы оно соответствовало последней еще не отмененной команде (если отменены все команды из набора lastCmds, то значение undoIndex полагается равным −1).

#### Метод Redo(count) восстанавливает count ранее отмененных команд, выполняя метод Execute для элементов структуры lastCmds, начиная с команды с индексом undoIndex + 1 в направлении увеличения индексов (если в структуре lastCmds содержится недостаточно элементов, то восстанавливаются все ранее отмененные команды). Кроме того, значение поля undoIndex корректируется так, чтобы оно соответствовало последней восстановленной команде.

#### Описанный механизм отмены/восстановления команд позволяет отменять и восстанавливать любое количество ранее выполненных команд (с сохранением их исходного порядка выполнения), однако при выполнении новой команды он блокирует возможность восстановления ранее отмененных команд (поскольку их результат может конфликтовать с результатом выполнения новой команды).

#### Тестирование разработанной системы классов. Даны два различных символа C1 и C2, которые могут принимать три значения: «A», «B», «C». Символ C1 определяет тип первого параметра конструктора объекта Menu (значение «A» соответствует классу CommandA, значение «B» — классу CommandB, значение «C» — классу CommandC). Аналогичным образом, символ C2 определяет тип второго параметра конструктора объекта Menu. Используя указанную информацию, создать объект m типа Menu.

#### Также дано целое число N (≤ 40), задающее количество методов объекта m для выполнения, и набор из N двухсимвольных строк, кодирующих требуемые методы. Первый символ каждой строки является одной из букв «I», «U», «R», а второй символ является цифрой, причем в случае первого символа «I» возможны только цифры «0», «1», «2», а в случае символов «U» и «R» — только цифры в диапазоне от «1» до «9». Строки «I0», «I1», «I2» соответствуют методу Invoke с параметрами 0, 1, 2; строки, начинающиеся с символа «U», соответствуют методу Undo, причем цифра определяет количество команд для отмены (например, строка «U4» соответствует методу Undo(4)); строки, начинающиеся с символа «R», соответствуют методу Redo, а цифра определяет количество восстанавливаемых команд.

#### Выполнить в указанном порядке все методы для созданного объекта m типа Menu. Выводить какие-либо данные не требуется, так как вывод осуществляется в классах-получателях ReceiverA, ReceiverB и ReceiverC при выполнении соответствующих команд. 