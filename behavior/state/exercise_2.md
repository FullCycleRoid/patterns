#### Задание 2. Реализовать набор классов, связанных с моделированием работы автомата по продаже шариков (ball machine).

#### Иерархия классов-состояний включает абстрактный класс State с абстрактными методами, описывающими возможные действия с автоматом — InsertCoin (вложить монетку), GetBall (получить шарик), ReturnCoin (вернуть монетку), AddBall (добавить шарик в автомат) — и набор конкретных классов, соответствующих различным возможным состояниям автомата: ReadyState (автомат содержит шарики и готов к приему монетки), HasPayedState (автомат получил монетку и готов выдать шарик или вернуть монетку), NoBallState (в автомате нет шариков). Все методы не имеют параметров и не возвращают значения.

#### Каждый конкретный класс содержит поле machine — ссылку на объект типа BallMachine; это поле инициализируется в конструкторе, имеющем одноименный параметр. Все переопределенные методы в каждом конкретном классе могут выводить соответствующее текстовое сообщение, изменять состояние автомата, вызывая для объекта machine его метод SetState с подходящим параметром, и выполнять другие действия. Ниже перечисляются действия всех методов для конкретных классов-состояний.

#### Класс ReadyState:

• метод InsertCoin выводит текст «Coin is inserted» (монетка получена) и переводит автомат в состояние HasPayedState;

• методы GetBall и ReturnCoin выводят текст «You need to pay first» (вначале заплатите);

• метод AddBall не выполняет никаких действий.

#### Класс HasPayedState:

• метод InsertCoin выводит текст «You have already paid» (вы уже заплатили);

• метод ReturnCoin выводит текст «Take your coin» (получите вашу монетку) и переводит автомат в состояние ReadyState;

• метод AddBall, как и для предыдущего класса, не выполняет никаких действий;

• метод GetBall выводит текст «Take your ball» (получите ваш шарик) и, кроме того, вызывает метод DecreaseBallCount объекта machine и анализирует его возвращаемое значение (равное оставшемуся количеству шариков): если это значение больше нуля, то автомат переводится в состояние ReadyState, в противном случае автомат переводится в состояние NoBallState.

#### Класс NoBallState:

• методы InsertCoin, GetBall и ReturnCoin выводят текст «Sorry, balls are over» (извините, шарики закончились);

• метод AddBall переводит автомат в состояние ReadyState и не выводит сообщений.

#### Класс BallMachine содержит поле ballCount целого типа (равное текущему количеству шариков), поля ready, hasPayed и noBall типа State (в которых содержатся ссылки на соответствующие объекты-состояния), а также поле currentState типа State (в котором содержится ссылка на текущее состояние). Поля инициализируются в конструкторе без параметров; полю ballCount присваивается значение 3, а для инициализации полей ready, hasPayed и noBall используются конструкторы соответствующих классов с параметром — ссылкой на создаваемый объект типа BallMachine. Кроме того, в конструкторе выполняется присваивание полю currentState значения ready.

#### Класс BallMachine содержит методы InsertCoin, GetBall, ReturnCoin, AddBall, в которых выполняется вызов одноименных методов объекта currentState; в методе AddBall дополнительно выводится текст «Ball is added» (шарик добавлен) и выполняется увеличение на 1 поля ballCount. В классе также надо реализовать метод DecreaseBallCount без параметров, который уменьшает на 1 поле ballCount и возвращает новое значение этого поля (метод DecreaseBallCount используется в методе GetBall класса HasPayedState), и метод SetState(newState), который присваивает полю currentState значение параметра newState. Для доступа на чтение к полям ready, hasPayed и noBall надо предусмотреть методы GetReadyState, GetHasPayedState и GetNoBallState (эти методы, совместно с методом SetState, используются в методах классов-состояний для изменения состояния объекта BallMachine).

#### Тестирование разработанной системы классов. Дана строка S, содержащая только символы «I», «G», «R», «A»; каждый символ соответствует одной из команд автомата BallMachine: «I» — InsertCoin, «G» — GetBall, «R» — ReturnCoin, «A» — AddBall. Создать объект типа BallMachine и вызвать для него набор команд, соответствующий символам исходной строки S в порядке их следования в строке. Выводить какие-либо результаты не требуется, так как вывод осуществляется в методах, реализующих команды автомата. 